---
theme: white
defaultTemplate: "[[tpl-base-no-title]]"
transition: fade
slideNumber: c/t
# [pecha-kucha style]
# loop: false
# autoSlide: 60000
---

<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap');
.code-block-fixed {  
  display: block;  padding: 5px;  overflow: auto; min-height:100px; max-height: 100%;  word-wrap: normal;
}
.reveal .hljs:not(:first-child).fragment { box-sizing: content-box; }
.reveal, .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
  font-family: 'Noto Sans KR', sans-serif;
  text-transform: none;
  margin-bottom: 1px;
}
.reveal p {
  margin: 10px;
}
li:last-of-type {
  margin-bottom: 10px;
}
</style>

<!-- .slide: template="[[tpl-title]]" -->
::: title
X.509 PKI 기초<!-- element style="color: black" -->
:::

::: author
CAM연구소
:::

::: date
📆 2025-06-12
:::

---

## 목차
- X.509 인증서의 역사
- 인증서의 형태
- 주요 용어/형식
- 인증서 발급
	- CSR
- 인증서 폐지
	- CRL
	- OCSP
- 인증기관의 운영(CP/CPS)
- 인증서 관리 프로토콜(CMP)
- ACME 자동화 프로토콜
- 표준/가이드라인
	- PKCS
	- RFC
	- CA/B BR

---

## X.509 인증서의 역사
- **1978년, 콘펠더**  
    디피-헬만 공개키 방식의 문제 해결을 위해 '인증서(Certificate)' 개념 최초 제안  
    → 공개키 전송 시 전자 서명으로 신뢰 보장
- **1980년대, OSI 프로젝트**  
    대형 통신사업자들이 통합 전자 네트워크 구축 추진  
    → 국제 표준화 단체 ITU-T가 이메일 표준 **X.400** 개발  
    → 메시지 전송, 보안, 멀티미디어 등 전자메일 전반 표준화
- **X.500 디렉토리 서비스**  
    사용자 정보 저장 및 조회 위한 디렉토리 프로토콜  
    → 고유 이름(Distinguished Names, DN) 체계 도입  
    → 현재 DNS, LDAP의 기초가 됨
- 이들 표준을 기반으로 한 인증서 체계가 **X.509**로 발전

---

## 인증서의 형태 (1/2)
![[X.509 certificate sample.png]]

---

## 인증서의 형태 (2/2)
- 대부분의 경우 "인증서"는 X.509 v3 인증서임. 더 정확히 말하면, RFC 5280에 정의된 PKIX 변형을 의미하며,  CA/Browser Forum의 기준(Baseline Requirements)에 의해 추가로 다듬어진 형식임.
	- 즉, 대부분의 브라우저가 이해하고 HTTPS에서 사용하는 인증서 형식. 웹 PKI는 Internet PKI, PKIX라고도 불림.

**주의사항:**
- 인증서 필드값에 관한 규범은 시대에 따라 변화하였음
- 예(2025년 기준):
	- DN은 대부분의 경우 Optional임. DN을 기재하는 것은 과거 방식임
		- 최근의 모범 방식은 SAN에 Unique ID(DNS, 이메일 주소, IP, URI 등)를 기재하는 것

---

## 주요 형식

- BER (Basic Encoding Rules)
	- ASN.1 표준에서 정의된 기본 인코딩 규칙
	- Type-length-value (TLV) 인코딩
- DER (Distinguished Encoding Rules): 
	- BER의 하위 집합으로, Canonical Rule이 적용됨
	- 확장자는 보통 .der 또는 .cer
- PEM (Privacy Enhanced Mail): 
	- BEGIN CERTIFICATE로 시작하는 인코딩. base64로 인코딩된 DER 데이터를 포함함
	- 확장자는 보통 .pem, .crt, .cer
- (DER, PEM, CER, CRT, CSR, PFX, P12등의 확장자는 실무에서는 혼용되는 경우가 많음)

---

## 인증서 발급
- CSR - PKCS #10

---

## 인증서 폐지 (1/2)
- (CRL/OCSP 설명 생략)
- CRL의 문제점:
	- 인증서 검증을 위해 CRL 다운로드를 시도하는 것은 느리고 안정적이지 않음
	- 수백 MB 이상으로 커질 수 있음
	- CRL의 대부분의 내용은 클라이언트의 관심사가 아님
- OCSP의 문제점:
	- 유저가 어느 사이트에 접속했는지가 노출됨
	- 요청이 plain HTTP로 보내짐(MITM에게도 정보가 노출됨)
	- CA에게 연산 부담이 됨

---

## 인증서 폐지 (2/2)
- OCSP Stapling:
	- 웹 서버가 CA로부터 OCSP 응답을 받아 Cache함
	- OCSP 응답을 TLS 핸드쉐이크에 동봉함(stapled)
	- 단점:
		- 서버가 OCSP Stapling을 적용해야 하는 동인이 없음 - 실제 구현체에서 무시됨
- Short-lived Certificates:
	- Let's Encrypt (2015-11 창립) 등에서 채택한 방식
	- Baseline Requirement에 따르면 7~10일 유효기간의 인증서는 폐기될 필요가 없음
	- ACME등으로 인증서 갱신만 쉽게 자동화할 수 있도록 하면 됨

---

## 인증기관의 운영 (1/2)
- RFC 3647를 기반으로, 정책 기준과 운영 기준을 각각 CP, CPS의 형태로 작성 

| 항목  | **CP (Certificate Policy)**            | CPS (인증업무준칙)                              |
| --- | -------------------------------------- | ----------------------------------------- |
| 목적  | 인증서가 사용될 수 있는 조건과 신뢰 수준을 정의한 **정책 문서** | CA가 실제로 **그 정책을 어떻게 이행하고 있는지 설명하는 운영 문서** |
| 저자  | 상위 정책 기관, CA 운영 주체                     | CA 운영 주체 (인증기관)                           |
| 대상  | "무엇을 할 것인가" (**보안 요구사항과 목적**)          | "어떻게 할 것인가" (**운영 절차, 기술적 구현**)           |
| 내용  | 인증서의 사용 목적, 보증 수준, 인증 범위 등             | 키 생성, 인증서 발급 절차, HSM 사용 방식, 로그 관리 등       |
| 효력  | 신뢰 정책 선언, 상호 인증 판단 기준                  | 실무 책임 선언, 감사 기준이 되는 운영 문서                 |
| 감사  | CPS-CP간 정합성                            | 자체가 감사 기준 대상                              |

---

## 인증기관의 운영 (2/2)
- 운영의 어려움:
	- ![[chain of trust - meatspace.png]]

- 예시:
	- [AutoCrypt-V2X-PKI-Root-CA-Certificate-Practice-Statement-v1.1.pdf](https://atcrypt-my.sharepoint.com/personal/jwlee_autocrypt_io/Documents/Microsoft%20Teams%20Chat%20Files/AutoCrypt-V2X-PKI-Root-CA-Certificate-Practice-Statement-v1.1.pdf "https://atcrypt-my.sharepoint.com/personal/jwlee_autocrypt_io/Documents/Microsoft%20Teams%20Chat%20Files/AutoCrypt-V2X-PKI-Root-CA-Certificate-Practice-Statement-v1.1.pdf")
	- OID(인증서에 CP를 기재하기 위해 필요)
		- https://oid-base.com/get/1.3.6.1.4.1.63254
	- [Let's Encrypt](https://letsencrypt.org/documents/isrg-cp-cps-v5.7/)
	- [키 세레머니 예시](https://www.iana.org/dnssec/ceremonies/32)

---

## 인증서 관리 프로토콜
- CMP - RFC 4210, RFC 6712
- ACME (자동화)
	- Let's Encrypt (의의)
	- https://letsencrypt.org/stats/

---

## 표준/가이드라인 - PKCS

- PKCS #1 - RSA 암호 규정
- PKCS #7 - 암호메시지의 데이터 형식 
	- 인증서 묶음(체인 등)을 포함함
	- Java 환경에서 자주 사용. 확장자 .p7b, .p7c 
	- DER또는 PEM으로 인코딩 가능. 보통 DER로 제공됨
- PKCS #8 - 개인키 보존의 형식
- PKCS #10 - 인증서 신청(CSR) 
- PKCS #11 - Crypto API
- PKCS #12 - 인증서와 개인키 형식 
	- 인증서와 암호화된 개인 키를 함께 포함함
	- Microsoft에서 자주 사용. 확장자 .pfx, .p12 
	- DER또는 PEM으로 인코딩 가능. 보통 DER로 제공됨

[^1]: 실무에서는 7, 8, 12 가 혼용됨. 데이터나 확장자가 혼용되기도 함

---

## 표준/가이드라인 - RFC
- RFC 2692, 2693
	- 디지털 인증서의 기원
- RFC 3647
	- CP, CPS (CA, RA의 역할 및 운영 등 포함)
- RFC 4210, [RFC6712](https://datatracker.ietf.org/doc/html/rfc6712)
	- CMP 프로토콜
- RFC 5280
	- X.509 인증서의 프로파일
		- TLS/SSL, HTTPS, S/MIME등에 사용됨. IPsec등 예외 존재
	- [Zlint](https://cloud.google.com/certificate-authority-service/docs/rfc-compliance), [Demo](http://woojung3.iptime.org/zlint)
- RFC 6960
	- OCSP 및 OCSP Responder
- RFC 7525
	- TLS 보안 권장 설정

---

## 표준/가이드라인 - FIPS, CA/B BR
- FIPS
	- FIPS 140-2
		- HSM, 토큰 등 암호 연산 처리 제품에 대한 인정 제도. 레벨 1~4로 등급을 분류함
		- HSM 사용시 FIPS 요건을 잘 확인해야 함

- CA/B BR:
	- [CA/Browser Forum Baseline Requirements](https://cabforum.org/baseline-requirements/)
	- 웹 PKI에 대한 사실상의 표준 규격
	- 2012-07에 최초 공개됨
